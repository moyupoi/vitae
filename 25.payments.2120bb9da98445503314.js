webpackJsonp([25],{491:function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function r(e){return(0,d.default)({},p.CALL_API,{endpoint:h.default.api_root_v1+"/bookings/"+e,method:"GET",headers:(0,_.default)(h.default.headers,{Authorization:"Bearer "+y.default.load("token")}),types:[v,{type:P,payload:function(e,t,a){return a.json()}},S]})}function l(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"alipay",t=arguments[1];return(0,d.default)({},p.CALL_API,{endpoint:h.default.api_root_v1+"/payments/gateway/"+e+"/"+t,method:"GET",headers:(0,_.default)("wxjspay"==e?g:h.default.headers,{Authorization:"Bearer "+y.default.load("token")}),types:[T,{type:I,payload:function(e,t,a){return a.json()}},O]})}function o(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:F,t=arguments[1],a=w[t.type];return a?a(e,t):e}Object.defineProperty(t,"__esModule",{value:!0}),t.actions=t.PAY_FAILURE=t.PAY_SUCCESS=t.PAY_REQUEST=t.FETCH_BOOKING_FAILURE=t.FETCH_BOOKING_SUCCESS=t.FETCH_BOOKING_REQUEST=void 0;var i,u=a(6),s=n(u),f=a(8),d=n(f),c=a(194),_=n(c);t.fetchBooking=r,t.pay=l,t.default=o;var p=a(41),m=a(17),y=n(m),E=a(29),h=n(E),C=y.default.load("visitor_open_id")||y.default.load("wx_open_id"),g=C?(0,_.default)(h.default.headers,{"X-ZBJ-WX-UID":C}):h.default.headers,v=t.FETCH_BOOKING_REQUEST="FETCH_BOOKING_REQUEST",P=t.FETCH_BOOKING_SUCCESS="FETCH_BOOKING_SUCCESS",S=t.FETCH_BOOKING_FAILURE="FETCH_BOOKING_FAILURE",T=t.PAY_REQUEST="PAY_REQUEST",I=t.PAY_SUCCESS="PAY_SUCCESS",O=t.PAY_FAILURE="PAY_FAILURE",w=(t.actions={fetchBooking:r,pay:l},i={},(0,d.default)(i,v,function(e,t){return(0,s.default)({},e,{order:{isFetching:!0,error:{},info:{}}})}),(0,d.default)(i,P,function(e,t){return(0,s.default)({},e,{order:{isFetching:!1,error:{},info:t.payload}})}),(0,d.default)(i,S,function(e,t){return(0,s.default)({},e,{order:{isFetching:!1,error:{},info:{}}})}),(0,d.default)(i,T,function(e,t){return(0,s.default)({},e,{message:{isFetching:!0,error:{},info:{}}})}),(0,d.default)(i,I,function(e,t){return(0,s.default)({},e,{message:{isFetching:!1,error:{},info:t.payload}})}),(0,d.default)(i,O,function(e,t){return(0,s.default)({},e,{message:{isFetching:!1,error:t.payload,info:{}}})}),i),F={order:{isFetching:!1,error:{},info:{}},message:{}}},817:function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=a(11),l=n(r),o=a(2),i=n(o),u=a(12),s=n(u),f=a(4),d=n(f),c=a(3),_=n(c),p=a(1),m=n(p),y=a(1148),E=n(y),h=function(e){function t(){return(0,i.default)(this,t),(0,d.default)(this,(t.__proto__||(0,l.default)(t)).apply(this,arguments))}return(0,_.default)(t,e),(0,s.default)(t,[{key:"render",value:function(){var e=this.props,t=e.offer,a=e.totalPrice;return m.default.createElement("div",{className:E.default.houseCon},m.default.createElement("img",{className:E.default.showImg,src:t.primary_image.oi750x500_url}),m.default.createElement("div",{className:E.default.detailCon},m.default.createElement("h2",{className:E.default.title},t.name),m.default.createElement("p",{className:E.default.city},"City:",t.city),m.default.createElement("em",{className:E.default.num},"最多",t.max_guest_count,"人",m.default.createElement("span",null,t.bedroom_count,"床"),t.bedroom_count,"卧室"),m.default.createElement("p",{className:E.default.price},"¥",a)))}}]),t}(p.Component);h.propTypes={offer:m.default.PropTypes.object.isRequired,totalPrice:m.default.PropTypes.number.isRequired},t.default=h},818:function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=a(11),l=n(r),o=a(2),i=n(o),u=a(12),s=n(u),f=a(4),d=n(f),c=a(3),_=n(c),p=a(20),m=n(p),y=a(1),E=n(y),h=a(44),C=n(h),g=a(62),v=n(g),P=a(817),S=n(P),T=a(52),I=a(1149),O=n(I),w=a(15),F=a(121),N=function(e){function t(e){(0,i.default)(this,t);var a=(0,d.default)(this,(t.__proto__||(0,l.default)(t)).call(this,e));return a.toPay=a.toPay.bind(a),a}return(0,_.default)(t,e),(0,s.default)(t,[{key:"componentDidMount",value:function(){var e=this.props,t=e.params,a=e.fetchBooking,n=e.setTitle;n("订单支付"),(0,T.bindWechat)("订单支付 - 住百家","不住酒店,住百家"),a(t.id)}},{key:"componentWillReceiveProps",value:function(e){if(e.payments.message.info&&e.payments.message.info.url)window.location.href=e.payments.message.info.url;else if(e.payments.message.info&&e.payments.message.info.type&&"wx_wap"==e.payments.message.info.type){var t=e.payments.message.info;wx.chooseWXPay({timestamp:t.timeStamp.toString(),nonceStr:t.nonceStr,package:t.package,signType:"MD5",paySign:t.paySign,success:function(t){window.location.href="/customer/payment_results/"+e.params.id}})}}},{key:"isWeixinBrowser",value:function(){var e=navigator.userAgent.toLowerCase();return!!/micromessenger/.test(e)}},{key:"toPay",value:function(e,t){var a=this.props.pay;a(e,t);var n="";"alipay"===e?n="支付宝":"acp"===e?n="银联":"wxjspay"===e&&(n="微信"),(0,w.saBtnClick)(n,"订单页"),(0,w.saSelector)("订单页","支付方式",n)}},{key:"render",value:function(){var e=this.props.payments,t=e.order,a=t.isFetching,n=t.info;return E.default.createElement("div",null,a&&(0,m.default)(n)&&E.default.createElement(v.default,null),!(0,m.default)(n)&&E.default.createElement("div",{style:{opacity:a?.5:1}},E.default.createElement(C.default,{title:"订单支付 - 住百家 "}),E.default.createElement(S.default,{offer:n.offer,totalPrice:n.total_price}),E.default.createElement("div",{className:O.default.payMent},E.default.createElement("ul",{className:O.default.listCon},!this.isWeixinBrowser()&&E.default.createElement("li",{onClick:this.toPay.bind(this,"alipay",n.bill_no)},E.default.createElement("span",{className:O.default.alipayIcon}),E.default.createElement("h3",null,"支付宝支付 (推荐)"),E.default.createElement("i",{className:O.default.arrow})),E.default.createElement("li",{onClick:this.toPay.bind(this,"acp",n.bill_no)},E.default.createElement("span",{className:O.default.acpIcon}),E.default.createElement("h3",null,"银联支付"),E.default.createElement("i",{className:O.default.arrow})),this.isWeixinBrowser()&&"alipay"!==(0,F.browserType)()&&E.default.createElement("li",{onClick:this.toPay.bind(this,"wxjspay",n.bill_no)},E.default.createElement("span",{className:O.default.wxjspayIcon}),E.default.createElement("h3",null,"微信支付"),E.default.createElement("i",{className:O.default.arrow}))))))}}]),t}(y.Component);N.propTypes={payments:E.default.PropTypes.object.isRequired,fetchBooking:E.default.PropTypes.func.isRequired,setTitle:E.default.PropTypes.func.isRequired,params:E.default.PropTypes.object.isRequired,pay:E.default.PropTypes.func.isRequired},t.default=N},819:function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=a(28),l=a(491),o=a(42),i=a(818),u=n(i),s={fetchBooking:l.fetchBooking,pay:l.pay,setTitle:o.setTitle},f=function(e){return{payments:e.payments,user:e.user}};t.default=(0,r.connect)(f,s)(u.default)},1148:function(e,t){e.exports={clearFix:"OfferCard__clearFix___3Hzhh",ellipsis:"OfferCard__ellipsis___3cMe8",houseCon:"OfferCard__houseCon___IzMPe",detailCon:"OfferCard__detailCon___2JqYV",city:"OfferCard__city___1s5O3",title:"OfferCard__title___2D7gv",showImg:"OfferCard__showImg___2fGTb",num:"OfferCard__num___2diyx",price:"OfferCard__price___2SfIK"}},1149:function(e,t){e.exports={listCon:"Payments__listCon___2cxEk",alipayIcon:"Payments__alipayIcon___Yn8Vz",acpIcon:"Payments__acpIcon___1VntS",wxjspayIcon:"Payments__wxjspayIcon___aps9Y",arrow:"Payments__arrow___3Gda8"}}});